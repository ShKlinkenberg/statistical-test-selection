---
title: Test Selection Scheme
layout: column-page
---


```{r}
library("readr")
data_wide_read <- read_csv2("test_selection_scheme_wide.csv")
```


```{r}
#| column: screen

# install.packages("DT")
library(DT)

datatable(
  data_wide_read,
  filter = "top",
  rownames = FALSE,
  options = list(
    pageLength = 25,
    dom = "ltipr",
    scrollX = TRUE
  )
)
```

Create decision tree


```{r}
#| eval: false

col_names <- names(data_wide_read)

# Creat variables for mermaid syntax for flowchart decision nodes
mmd_decision_node_var <- c("DVn", "DVt", "IVn", "IVt", "IVc", "Samp", "PT", "NPT")

# Creat shortened mermaid syntax for flowchart decision nodes
mmd_decision_node_names <- c("DV#", "DV<br>type", "#IV", "IV<br>type", "#Cat", "Samp")

# Add varible names to dataframe
# Add mmd_decision_node_var and romove spaces
data_wide_read$DVn <- paste0(mmd_decision_node_var[1], gsub(" ","",data_wide_read$'DV number') )

# Do the same for the other decision nodes
data_wide_read$DVt  <- paste0(data_wide_read$DVn, gsub(" ","",data_wide_read$'DV type') )
data_wide_read$IVn  <- paste0(data_wide_read$DVt, gsub(" ","",data_wide_read$'IV number') )
data_wide_read$IVt  <- paste0(data_wide_read$IVn, gsub(" ","",data_wide_read$'IV type') )
data_wide_read$IVc  <- paste0(data_wide_read$IVt, gsub(" ","",data_wide_read$'IV categories') )
data_wide_read$Samp <- paste0(data_wide_read$IVc, gsub(" ","",data_wide_read$'Sampled') )
data_wide_read$PT   <- paste0(mmd_decision_node_var[7], gsub(" |\\(|\\)","",data_wide_read$'Parametric Test') )
data_wide_read$NPT  <- paste0(mmd_decision_node_var[8], gsub(" ","",data_wide_read$'Non-parametric test') )

DVn2DVt <- unique(
sprintf("  DVn{#DV} -->|%s| %s{%s}\n",
        data_wide_read$'DV number',
        data_wide_read$DVn,
        mmd_decision_node_names[2])
)

DVt2IVn <- unique(
sprintf("  %s -->|%s| %s{%s}\n",
        data_wide_read$DVn,
        data_wide_read$'DV type',
        data_wide_read$DVt,
        mmd_decision_node_names[3])
        )

IVn2IVt <- unique(
sprintf("  %s -->|%s| %s{%s}\n",
        data_wide_read$DVt,
        data_wide_read$'IV number', # match
        data_wide_read$IVn,         # match
        mmd_decision_node_names[4]) # next node
        )

IVt2IVc <- unique(
sprintf("  %s -->|%s| %s{%s}\n",
        data_wide_read$IVn,
        data_wide_read$'IV categories', # match
        data_wide_read$IVc,         # match
        mmd_decision_node_names[5]) # next node
        )

IVc2IVs <- unique(
sprintf("  %s -->|%s| %s{%s}\n",
        data_wide_read$IVc,
        data_wide_read$'Sampled',   # match
        data_wide_read$Samp,        # match
        mmd_decision_node_names[6]) # next node
        )

IVs2PT <- unique(
sprintf('  %s --> %s["%s"]\n',
        data_wide_read$Samp,
        data_wide_read$PT,                # match
        data_wide_read$'Parametric Test') # match
        )

PT2NPT <- unique(
sprintf('  %s --> %s["%s"]\n',
        data_wide_read$PT,
        data_wide_read$NPT,                   # match
        data_wide_read$'Non-parametric test') # match
        )

DVn2DVt
DVt2IVn
IVn2IVt
IVt2IVc
IVc2IVs
IVs2PT
PT2NPT



cat("flowchart LR\n", file = "output.mmd")

cat(DVn2DVt, DVt2IVn, IVn2IVt, IVt2IVc, IVc2IVs, IVs2PT,
    "subgraph Parametric Tests\n",
    paste0(data_wide_read$NPT,collapse = "\n"),
    "\nend\n",
    "subgraph Non Parametric Tests\n",
    PT2NPT,
    "end\n",
    sep = "",
    file = "output.mmd",
    append = TRUE)

```



```{mermaid}
graph LR
  A[Hard edge] --> B(Round edge)
  B --> C{Decision}
  C --> D[Result one]
  C --> E[Result two]
```